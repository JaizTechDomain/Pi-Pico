Some of my own code, credits to NerdCave (Guitarman9119 on github) for alot of the code I have adapted to work
